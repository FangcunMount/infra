# Infra - ä¼ä¸šçº§åŸºç¡€è®¾æ–½å³ä»£ç 

> ğŸ—ï¸ ç”Ÿäº§çº§åŸºç¡€è®¾æ–½å¹³å°ï¼Œä¸ºä¸šåŠ¡åº”ç”¨æä¾›ç¨³å®šå¯é çš„è¿è¡Œç¯## ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **ğŸ§© æ¨¡å—åŒ–æ¶æ„**: æ¯ä¸ªæœåŠ¡ç‹¬ç«‹é…ç½®ã€ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹æ‰©å±•
- **ğŸ³ å®Œå…¨å®¹å™¨åŒ–**: åŸºäº Docker Compose çš„ç¼–æ’ç®¡ç†
- **ğŸ›ï¸ è‡ªåŠ¨åŒ–éƒ¨ç½²**: å®Œæ•´çš„è„šæœ¬åŒ–éƒ¨ç½²å’Œå¥åº·æ£€æŸ¥ä½“ç³»
- **ğŸŒ ç¯å¢ƒä¸€è‡´æ€§**: å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®æ ‡å‡†åŒ–
- **ğŸ“Š è¿ç»´å‹å¥½**: å†…ç½®ç›‘æ§ã€æ—¥å¿—ã€ç®¡ç†ç•Œé¢

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### ğŸš€ å¿«é€Ÿä¸Šæ‰‹
- [ğŸ“– é¡¹ç›®æ¦‚è§ˆ](README.md) - é¡¹ç›®ä»‹ç»å’Œæ¶æ„æ¦‚è¿°ï¼ˆæœ¬æ–‡æ¡£ï¼‰

### ğŸ”§ æœåŠ¡å™¨åˆå§‹åŒ–
- [ğŸ‘¥ ç”¨æˆ·ç¯å¢ƒé…ç½®](docs/æœåŠ¡å™¨åˆå§‹åŒ–--ç”¨æˆ·.md) - ç”¨æˆ·æƒé™ã€SSHå¯†é’¥ç­‰åŸºç¡€é…ç½®
- [ğŸŒ ç½‘ç»œç¯å¢ƒé…ç½®](docs/æœåŠ¡å™¨åˆå§‹åŒ–--ç½‘ç»œç¯å¢ƒ.md) - VPNä»£ç†ã€é˜²ç«å¢™ã€ç½‘ç»œä¼˜åŒ–
- [ğŸ³ Docker å®‰è£…é…ç½®](docs/æœåŠ¡å™¨åˆå§‹åŒ–--docker.md) - Dockerç¯å¢ƒå®‰è£…å’Œé…ç½®ä¼˜åŒ–

### ğŸ—ï¸ åŸºç¡€è®¾æ–½éƒ¨ç½²ï¼ˆæ¨èé¡ºåºï¼‰
1. [ğŸ”§ ç½‘ç»œ&åŸºç¡€å·](docs/æœåŠ¡å™¨ç»„ä»¶--ç½‘ç»œ&åŸºç¡€å·.md) - Dockerç½‘ç»œå’Œæ•°æ®å·åˆå§‹åŒ–
2. [ğŸ—„ï¸ å­˜å‚¨æœåŠ¡](docs/æœåŠ¡å™¨ç»„ä»¶--å­˜å‚¨æœåŠ¡(MySQL_Redis_MongoDB).md) - MySQL/Redis/MongoDBæ•°æ®åº“é›†ç¾¤
3. [ğŸ“¨ æ¶ˆæ¯æœåŠ¡](docs/æœåŠ¡å™¨ç»„ä»¶--æ¶ˆæ¯æœåŠ¡(Kafka).md) - Kafkaæ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ  
4. [ğŸ”§ CI/CDæœåŠ¡](docs/æœåŠ¡å™¨ç»„ä»¶--CI_CD(Jenkins).md) - JenkinsæŒç»­é›†æˆå¹³å°
5. [ğŸŒ ç½‘å…³æœåŠ¡](docs/æœåŠ¡å™¨ç»„ä»¶--ç½‘å…³(Nginx).md) - Nginxåå‘ä»£ç†å’ŒSSLç»ˆç«¯

### ğŸ¯ éƒ¨ç½²ç­–ç•¥
**æ¨èéƒ¨ç½²é¡ºåº**: ç½‘ç»œ&åŸºç¡€å· â†’ å­˜å‚¨æœåŠ¡ â†’ æ¶ˆæ¯æœåŠ¡ â†’ CI/CD â†’ ç½‘å…³æœåŠ¡

> ğŸ’¡ **é‡è¦æç¤º**: è¯·æŒ‰ç…§æ¨èé¡ºåºè¿›è¡Œéƒ¨ç½²ï¼Œç¡®ä¿æœåŠ¡é—´ä¾èµ–å…³ç³»å¾—åˆ°æ­£ç¡®å¤„ç†ã€‚
## ğŸ¯ é¡¹ç›®å®šä½

æœ¬é¡¹ç›®ä¸“æ³¨äº**çº¯åŸºç¡€è®¾æ–½æœåŠ¡**ï¼Œéµå¾ª"åŸºç¡€è®¾æ–½ä¸åº”ç”¨åˆ†ç¦»"çš„è®¾è®¡åŸåˆ™ï¼š
- âœ… **åŒ…å«**: æ•°æ®åº“ã€ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç½‘å…³ã€CI/CDç­‰å…±äº«åŸºç¡€æœåŠ¡
- âŒ **ä¸åŒ…å«**: å…·ä½“ä¸šåŠ¡åº”ç”¨çš„éƒ¨ç½²é…ç½®ï¼ˆåº”åœ¨å„è‡ªé¡¹ç›®ä¸­ç®¡ç†ï¼‰

## ğŸ—ï¸ æœåŠ¡å™¨æ¶æ„è®¾è®¡

### ğŸ”§ åŸºç¡€è®¾æ–½æœåŠ¡çŸ©é˜µ

| æœåŠ¡ç±»å‹ | æœåŠ¡ç»„ä»¶ | ç«¯å£ | ç”¨é€” | ç¯å¢ƒ |
|---------|---------|------|------|------|
| **ğŸ—„ï¸ æ•°æ®å­˜å‚¨** | MySQL | 3306 | å…³ç³»å‹æ•°æ®åº“ | å†…ç½‘ |
| | Redis | 6379 | å†…å­˜ç¼“å­˜ | å†…ç½‘ |
| | MongoDB | 27017 | æ–‡æ¡£æ•°æ®åº“ | å†…ç½‘ |
| **ğŸ“¨ æ¶ˆæ¯é˜Ÿåˆ—** | Kafka | 9092 | åˆ†å¸ƒå¼æ¶ˆæ¯ | å†…ç½‘ |
| **ğŸŒ ç½‘å…³ä»£ç†** | Nginx | 80/443 | åå‘ä»£ç†+SSL | å…¬ç½‘ |
| **ğŸ”§ CI/CD** | Jenkins | 8080 | æŒç»­é›†æˆ | å†…ç½‘ |

### ğŸ¢ ç½‘ç»œæ¶æ„æ‹“æ‰‘

```
ğŸŒ Internet
     â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nginx   â”‚â”€â”€â”€â”€â–¶â”‚          infra-frontend ç½‘ç»œ            â”‚
â”‚ (ç½‘å…³)  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚         åº”ç”¨æœåŠ¡åŒºåŸŸ                 â”‚ â”‚
                â”‚  â”‚    (ä¸šåŠ¡åº”ç”¨å®¹å™¨éƒ¨ç½²åŒº)              â”‚ â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚        infra-backend ç½‘ç»œ              â”‚
                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚  â”‚  MySQL   â”‚ â”‚  Redis   â”‚ â”‚ MongoDB â”‚ â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚  â”‚  Kafka   â”‚ â”‚ Jenkins  â”‚ â”‚  ç®¡ç†UI â”‚ â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”’ å®‰å…¨è®¾è®¡åŸåˆ™
- **ç½‘ç»œéš”ç¦»**: å‰åç«¯ç½‘ç»œåˆ†ç¦»ï¼ŒåŸºç¡€è®¾æ–½æœåŠ¡ä¸ç›´æ¥æš´éœ²
- **æœ€å°æƒé™**: åªå¼€æ”¾å¿…è¦çš„æœåŠ¡ç«¯å£
- **æ•°æ®æŒä¹…åŒ–**: æ‰€æœ‰æ•°æ®ä½¿ç”¨ç‹¬ç«‹ Docker å·å­˜å‚¨
- **ç¯å¢ƒéš”ç¦»**: å¼€å‘/ç”Ÿäº§ç¯å¢ƒå®Œå…¨åˆ†ç¦»é…ç½®

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **ğŸ§© æ¨¡å—åŒ–æ¶æ„**: æ¯ä¸ªæœåŠ¡ç‹¬ç«‹é…ç½®ã€ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹æ‰©å±•
- **ï¿½ å®Œå…¨å®¹å™¨åŒ–**: åŸºäº Docker Compose çš„ç¼–æ’ç®¡ç†
- **ğŸ›ï¸ è‡ªåŠ¨åŒ–éƒ¨ç½²**: å®Œæ•´çš„è„šæœ¬åŒ–éƒ¨ç½²å’Œå¥åº·æ£€æŸ¥ä½“ç³»
- **ğŸŒ ç¯å¢ƒä¸€è‡´æ€§**: å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®æ ‡å‡†åŒ–
- **ğŸ“Š è¿ç»´å‹å¥½**: å†…ç½®ç›‘æ§ã€æ—¥å¿—ã€ç®¡ç†ç•Œé¢

## ğŸ¢ æ¶æ„æ¦‚è§ˆ

### ç½‘ç»œæ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å¤–éƒ¨è®¿é—®å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            Nginx (ç«¯å£ 80/443)              â”‚   â”‚
â”‚  â”‚         SSLç»ˆç»“ + åå‘ä»£ç†                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åŸºç¡€è®¾æ–½æœåŠ¡å±‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚    MySQL     â”‚  â”‚    Redis     â”‚  â”‚   MongoDB   â”‚â”‚
â”‚  â”‚   (3306)     â”‚  â”‚   (6379)     â”‚  â”‚   (27017)   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚    Kafka     â”‚  â”‚   Jenkins    â”‚  â”‚   ç®¡ç†ç•Œé¢   â”‚â”‚
â”‚  â”‚   (9092)     â”‚  â”‚   (8080)     â”‚  â”‚   (å¼€å‘)    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨æœåŠ¡å±‚                         â”‚
â”‚           (ç”±å„åº”ç”¨é¡¹ç›®è‡ªè¡Œç®¡ç†)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   miniblog   â”‚  â”‚    qs-api    â”‚  â”‚     ...     â”‚â”‚
â”‚  â”‚   (8001)     â”‚  â”‚   (8002)     â”‚  â”‚             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### èŒè´£åˆ†ç¦»
- **Infra é¡¹ç›®**: ä»…ç®¡ç†åŸºç¡€è®¾æ–½æœåŠ¡
- **åº”ç”¨é¡¹ç›®**: å„è‡ªç®¡ç†éƒ¨ç½²é…ç½®ï¼Œè¿æ¥åˆ°åŸºç¡€è®¾æ–½ç½‘ç»œ
    class Internet,LB internet
```

## æœåŠ¡æ¸…å•

| æœåŠ¡ | èŠ‚ç‚¹ | ç«¯å£ | ç”¨é€” | èµ„æºé™åˆ¶ |
|------|------|------|------|----------|
| **Nginx** | A | 80, 443 | åå‘ä»£ç†/SSLç»ˆç»“ | 512MB |
| **MySQL** | A | 3306 | å…³ç³»å‹æ•°æ®åº“ | 1GB |
| **Redis** | A | 6379 | ç¼“å­˜/ä¼šè¯å­˜å‚¨ | 512MB |
| **MongoDB** | A | 27017 | æ–‡æ¡£æ•°æ®åº“ | 1GB |
| **Kafka** | B | 9092 | æ¶ˆæ¯é˜Ÿåˆ— | 1GB |
| **Zookeeper** | B | 2181 | é›†ç¾¤åè°ƒ | 512MB |

## éƒ¨ç½²è¦æ±‚

- Docker >= 20.x å’Œ Docker Compose
- Linux ç³»ç»Ÿï¼ˆæ¨è Ubuntu/CentOSï¼‰
- è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ç”¨äºæ•°æ®å­˜å‚¨

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†ä»£ç 

```bash
git clone <repo-url> infra && cd infra
```

### 2. åˆ›å»ºåŸºç¡€è®¾æ–½ï¼ˆç½‘ç»œ+å·ï¼‰

**è¿™æ˜¯æ‰€æœ‰æœåŠ¡çš„åŸºç¡€ï¼Œå¿…é¡»é¦–å…ˆæ‰§è¡Œï¼š**

```bash
# åˆ›å»º Docker ç½‘ç»œå’Œæ•°æ®å·
./scripts/init-components/init-infrastructure.sh create

# æ£€æŸ¥åŸºç¡€è®¾æ–½çŠ¶æ€
./scripts/init-components/init-infrastructure.sh status
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¼€å‘ç¯å¢ƒ
cp compose/env/dev/.env.example compose/env/dev/.env
vim compose/env/dev/.env

# ç”Ÿäº§ç¯å¢ƒ
cp compose/env/prod/.env.example compose/env/prod/.env
vim compose/env/prod/.env
```

### 4. éƒ¨ç½²åŸºç¡€è®¾æ–½æœåŠ¡

```bash
# å®‰è£…æ‰€æœ‰æ ¸å¿ƒæœåŠ¡
./scripts/init-components/install-components.sh all

# æˆ–åˆ†æ­¥å®‰è£…
./scripts/init-components/install-components.sh nginx     # ç½‘å…³
./scripts/init-components/install-components.sh mysql    # æ•°æ®åº“
./scripts/init-components/install-components.sh redis    # ç¼“å­˜
./scripts/init-components/install-components.sh kafka    # æ¶ˆæ¯é˜Ÿåˆ—
./scripts/init-components/install-components.sh jenkins  # CI/CD
```

### 5. ç®¡ç†æœåŠ¡

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
./scripts/init-components/compose-manager.sh status

# å¯åŠ¨/åœæ­¢æœåŠ¡
./scripts/init-components/compose-manager.sh infra up all
./scripts/init-components/compose-manager.sh infra down all

# æŸ¥çœ‹æ—¥å¿—
./scripts/init-components/compose-manager.sh logs nginx
```

### 6. éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥åŸºç¡€è®¾æ–½
./scripts/init-components/init-infrastructure.sh status

# æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
```

## ç¯å¢ƒé…ç½®

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿å¹¶ä¿®æ”¹ï¼š

```bash
cp compose/env/prod/.env.example compose/env/prod/.env
vim compose/env/prod/.env
```

ä¸»è¦é…ç½®é¡¹ï¼š

- `MYSQL_ROOT_PASSWORD` - MySQL root å¯†ç 
- `REDIS_PASSWORD` - Redis å¯†ç   
- `MONGO_INITDB_ROOT_PASSWORD` - MongoDB å¯†ç 
- `NODE_A_IP` / `NODE_B_IP` - èŠ‚ç‚¹ IP åœ°å€

## é¡¹ç›®ç»“æ„

```text
â”œâ”€â”€ compose/              # Docker Compose é…ç½®
â”œâ”€â”€ components/           # ç»„ä»¶é…ç½®æ–‡ä»¶  
â”œâ”€â”€ scripts/             # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ init-server/     # æœåŠ¡å™¨åˆå§‹åŒ–è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ init-users.sh        # ç”¨æˆ·ç¯å¢ƒåˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ install-docker.sh    # Docker å®‰è£…
â”‚   â”‚   â”œâ”€â”€ setup-network.sh     # ç½‘ç»œç¯å¢ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ diagnose-network.sh  # ç½‘ç»œç¯å¢ƒè¯Šæ–­
â”‚   â”‚   â””â”€â”€ update-static-files.sh # é™æ€æ–‡ä»¶æ›´æ–°
â”‚   â””â”€â”€ deploy/          # åº”ç”¨éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ static/              # é™æ€èµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ geosite.dat      # åŸŸååˆ†æµè§„åˆ™æ•°æ®åº“
â”‚   â””â”€â”€ geoip.metadb     # IPåœ°ç†ä½ç½®æ•°æ®åº“
â”œâ”€â”€ logs/               # æ—¥å¿—ç›®å½•
â””â”€â”€ Makefile            # ç®¡ç†å‘½ä»¤
```

## è‡ªåŠ¨åŒ–è„šæœ¬

é¡¹ç›®æä¾›å®Œæ•´çš„æœåŠ¡å™¨åˆå§‹åŒ–è„šæœ¬ï¼š

```bash
# 1. å®‰è£… Docker ç¯å¢ƒ
sudo ./scripts/init-server/install-docker.sh

# 2. åˆå§‹åŒ–ç”¨æˆ·ç¯å¢ƒ
sudo ./scripts/init-server/init-users.sh

# 3. é…ç½®ç½‘ç»œç¯å¢ƒï¼ˆVPNï¼‰- è‡ªåŠ¨ä½¿ç”¨é™æ€æ–‡ä»¶
sudo ./scripts/init-server/setup-network.sh

# 4. æ•…éšœè¯Šæ–­ï¼ˆå¦‚é‡é—®é¢˜ï¼‰
sudo ./scripts/init-server/diagnose-network.sh

# 5. æ›´æ–°é™æ€æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
./scripts/init-server/update-static-files.sh
```

## ç®¡ç†å‘½ä»¤

```bash
make help          # æŸ¥çœ‹å¸®åŠ©
make status        # æŸ¥çœ‹çŠ¶æ€
make logs          # æŸ¥çœ‹æ—¥å¿—
make down          # åœæ­¢æœåŠ¡
make clean         # æ¸…ç†èµ„æº

# VPN ç®¡ç†å‘½ä»¤
mihomo-control start|stop|restart|status|logs
mihomo-update      # æ›´æ–°è®¢é˜…é…ç½®
```

## å†…ç½‘ç¯å¢ƒéƒ¨ç½²

æœ¬é¡¹ç›®å®Œå…¨æ”¯æŒæ— å¤–ç½‘è¿æ¥çš„å†…ç½‘ç¯å¢ƒéƒ¨ç½²ï¼š

### ç‰¹æ€§æ”¯æŒ

- âœ… **è‡ªåŠ¨æ£€æµ‹å†…ç½‘ç¯å¢ƒ**ï¼šè„šæœ¬ä¼šè‡ªåŠ¨è¯†åˆ«æ˜¯å¦å¤„äºå†…ç½‘ç¯å¢ƒ
- âœ… **ä¾èµ–åŒ…ç¦»çº¿å®‰è£…**ï¼šæ”¯æŒè·³è¿‡å¤–ç½‘ä¾èµ–ï¼Œä½¿ç”¨æœ¬åœ°åŒ…ç®¡ç†
- âœ… **Dockeré•œåƒé¢„åŠ è½½**ï¼šæ”¯æŒé¢„å…ˆå¯¼å…¥çš„é•œåƒï¼Œæ— éœ€åœ¨çº¿æ‹‰å–
- âœ… **åœ°ç†æ•°æ®æ–‡ä»¶æ›¿ä»£**ï¼šæä¾›åŸºç¡€è§„åˆ™é…ç½®æ›¿ä»£åœ¨çº¿æ•°æ®æ–‡ä»¶
- âœ… **é…ç½®æ–‡ä»¶æ‰‹åŠ¨éƒ¨ç½²**ï¼šæ”¯æŒç¦»çº¿é…ç½®æ–‡ä»¶éƒ¨ç½²

### å†…ç½‘éƒ¨ç½²æŒ‡å—

è¯¦ç»†çš„å†…ç½‘ç¯å¢ƒå®‰è£…æŒ‡å—è¯·å‚è€ƒï¼š**[INTRANET_SETUP_GUIDE.md](./INTRANET_SETUP_GUIDE.md)**

### å¿«é€Ÿå†…ç½‘éƒ¨ç½²

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨æœ¬åœ°é™æ€æ–‡ä»¶ï¼ˆæ¨èï¼‰

```bash
# 1. åœ¨æœ‰ç½‘ç»œçš„æœºå™¨ä¸Šæ›´æ–°é™æ€æ–‡ä»¶
./scripts/update-static-files.sh

# 2. ä¼ è¾“æ•´ä¸ªé¡¹ç›®åˆ°å†…ç½‘æœåŠ¡å™¨ï¼ˆåŒ…å« static/ ç›®å½•ï¼‰

# 3. åœ¨å†…ç½‘æœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆè„šæœ¬è‡ªåŠ¨ä½¿ç”¨é™æ€æ–‡ä»¶ï¼‰
sudo ./scripts/init-server/setup-network.sh
```

#### æ–¹æ¡ˆ2ï¼šä¼ ç»Ÿç¦»çº¿éƒ¨ç½²

```bash
# 1. é¢„å…ˆå‡†å¤‡èµ„æºï¼ˆåœ¨æœ‰ç½‘ç»œçš„æœºå™¨ä¸Šï¼‰
# - Docker é•œåƒï¼šdocker save metacubex/mihomo:latest > mihomo.tar
# - åœ°ç†æ•°æ®ï¼šä¸‹è½½ GeoSite.dat å’Œ GeoIP.metadb
# - é…ç½®æ–‡ä»¶ï¼šä¸‹è½½è®¢é˜…é…ç½®æ–‡ä»¶

# 2. ä¼ è¾“èµ„æºåˆ°å†…ç½‘æœåŠ¡å™¨

# 3. å¯¼å…¥é•œåƒ
docker load < mihomo.tar

# 4. è¿è¡Œå®‰è£…è„šæœ¬ï¼ˆè‡ªåŠ¨æ£€æµ‹å†…ç½‘ç¯å¢ƒï¼‰
sudo ./scripts/init-server/setup-network.sh
```

---

æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ [QUICKSTART.md](./QUICKSTART.md)
