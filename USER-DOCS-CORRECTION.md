# ç”¨æˆ·æ–‡æ¡£æ›´æ­£æŠ¥å‘Š

## ğŸ” **é—®é¢˜å‘ç°**

ç”¨æˆ·åé¦ˆ `docs/æœåŠ¡å™¨åˆå§‹åŒ–--ç”¨æˆ·.md` æ–‡æ¡£å†…å®¹ä¸å®é™…çš„ `scripts/init-server/init-users.sh` è„šæœ¬ä¸ç¬¦ã€‚

## ğŸ“Š **å¯¹æ¯”åˆ†æ**

### **æ–‡æ¡£ä¸­çš„é”™è¯¯å†…å®¹ (å·²ä¿®æ­£)**
```markdown
âŒ åŸæ–‡æ¡£æè¿°çš„ç”¨æˆ·ï¼š
- admin (ç®¡ç†å‘˜)
- appuser (åº”ç”¨ç”¨æˆ·)  
- deploy (éƒ¨ç½²ç”¨æˆ·)
- monitor (ç›‘æ§ç”¨æˆ·)

âŒ åŸæ–‡æ¡£æè¿°çš„ç”¨æˆ·ç»„ï¼š
- wheel, docker, appgroup, deploy
```

### **å®é™…è„šæœ¬åˆ›å»ºçš„ç”¨æˆ· âœ…**
```bash
âœ… init-users.sh å®é™…åˆ›å»ºï¼š
- www (åº”ç”¨ç®¡ç†ç”¨æˆ·)
- yangshujie (å¼€å‘ç”¨æˆ·)
- root (ç³»ç»Ÿç®¡ç†ï¼Œå¢å¼ºé…ç½®)

âœ… å®é™…æƒé™é…ç½®ï¼š
- ä¸¤ä¸ªç”¨æˆ·éƒ½åŠ å…¥ sudo ç»„
- www ç”¨æˆ·åˆ›å»º SSH Ed25519 å¯†é’¥å¯¹
- æ‰€æœ‰ç”¨æˆ·é…ç½® .bashrc å’Œå·¥ä½œç¯å¢ƒ
```

## ğŸ”§ **æ–‡æ¡£ä¿®æ­£å†…å®¹**

### **1. ç”¨æˆ·è§’è‰²è§„åˆ’è¡¨ (å·²æ›´æ–°)**
```markdown
| ç”¨æˆ·ç±»å‹ | ç”¨æˆ·å | ä¸»è¦èŒè´£ | sudo æƒé™ | SSH è®¿é—® | å·¥ä½œç›®å½• |
|---------|--------|----------|-----------|----------|----------|
| **åº”ç”¨ç®¡ç†** | `www` | åº”ç”¨éƒ¨ç½²ã€å®¹å™¨ç®¡ç† | âœ… sudo ç»„ | âœ… Ed25519 å¯†é’¥ | `/home/www/workspace` |
| **å¼€å‘ç”¨æˆ·** | `yangshujie` | å¼€å‘ã€æµ‹è¯• | âœ… sudo ç»„ | âŒ æ—  | `/home/yangshujie/workspace` |
| **ç³»ç»Ÿç”¨æˆ·** | `root` | ç³»ç»Ÿç®¡ç† | âœ… å®Œå…¨ | âœ… é…ç½® | `/root/workspace` |
```

### **2. è„šæœ¬æ‰§è¡Œæµç¨‹ (å·²æ›´æ–°)**
```bash
# å®é™…æ‰§è¡Œé¡ºåº (åŸºäº init-users.sh)
1. æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒ (root æƒé™ã€æ“ä½œç³»ç»Ÿã€ä¾èµ–)
2. è®¾ç½®ç³»ç»Ÿé»˜è®¤ Shell ä¸º bash  
3. é…ç½® root ç”¨æˆ· .bashrc (å¤‡ä»½åŸæ–‡ä»¶)
4. åˆ›å»ºç”¨æˆ· www å’Œ yangshujie
5. è®¾ç½®ç”¨æˆ·å¯†ç  (äº¤äº’å¼ï¼Œå¼ºåº¦éªŒè¯)
6. æ·»åŠ  sudo æƒé™ (åŠ å…¥ sudo ç»„)
7. ä¸º www ç”¨æˆ·åˆ›å»º SSH Ed25519 å¯†é’¥å¯¹
8. é…ç½®ç”¨æˆ· .bashrc å’Œå·¥ä½œç¯å¢ƒ
9. éªŒè¯ç”¨æˆ·é…ç½®æ­£ç¡®æ€§
```

### **3. æ‰‹åŠ¨é…ç½®æ­¥éª¤ (å·²æ›´æ–°)**
- âœ… ä¿®æ­£ä¸ºå®é™…çš„ç”¨æˆ·åˆ›å»ºæµç¨‹
- âœ… æ·»åŠ çœŸå®çš„ SSH å¯†é’¥ç”Ÿæˆæ­¥éª¤
- âœ… åŒ…å«å®é™…çš„ .bashrc é…ç½®å†…å®¹

### **4. æ–°å¢ Docker æƒé™é…ç½®ç« èŠ‚**
```bash
# é‡è¦è¡¥å……ï¼šä¸ºç”¨æˆ·æ·»åŠ  Docker æƒé™
sudo groupadd docker 2>/dev/null || true
sudo usermod -aG docker www
sudo usermod -aG docker yangshujie
```

## ğŸ¯ **å…³é”®å‘ç°**

### **è„šæœ¬çš„å®é™…ç‰¹ç‚¹**
1. **ç®€åŒ–è®¾è®¡**: åªåˆ›å»ºä¸¤ä¸ªæ ¸å¿ƒç”¨æˆ· (www + yangshujie)
2. **å®ç”¨é…ç½®**: é‡ç‚¹é…ç½®å·¥ä½œç¯å¢ƒå’Œ SSH å¯†é’¥
3. **å®‰å…¨è€ƒè™‘**: å¯†ç å¼ºåº¦éªŒè¯ï¼ŒSSH å¯†é’¥è®¤è¯
4. **å¼€å‘å‹å¥½**: é¢„é…ç½®åˆ«åå’Œå·¥ä½œç›®å½•

### **éœ€è¦è¡¥å……çš„é…ç½®**
1. **Docker æƒé™**: è„šæœ¬æœªè‡ªåŠ¨æ·»åŠ ï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ
2. **SSH å…¬é’¥**: éœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ° GitHub Deploy Key
3. **ç¯å¢ƒåº”ç”¨**: éœ€è¦é‡æ–°ç™»å½•ä»¥åº”ç”¨ .bashrc é…ç½®

## ğŸ“‹ **ç”¨æˆ·ä½¿ç”¨æŒ‡å— (æ›´æ–°å)**

### **æ‰§è¡Œè„šæœ¬**
```bash
sudo ./scripts/init-server/init-users.sh
```

### **è¡¥å…… Docker æƒé™**
```bash
sudo usermod -aG docker www
sudo usermod -aG docker yangshujie
```

### **ä½¿ç”¨ www ç”¨æˆ·è¿è¡ŒåŸºç¡€è®¾æ–½**
```bash
su - www
cd workspace/infra
make init-infra
make up-storage
```

## ğŸ‰ **æ–‡æ¡£ä¿®æ­£å®Œæˆ**

**æ–‡æ¡£ç°åœ¨å‡†ç¡®åæ˜ äº† `init-users.sh` è„šæœ¬çš„å®é™…è¡Œä¸ºå’Œé…ç½®ï¼**

- âœ… ç”¨æˆ·è§’è‰²è¡¨ä¸å®é™…ä¸€è‡´
- âœ… æ‰§è¡Œæµç¨‹ç¬¦åˆè„šæœ¬é€»è¾‘  
- âœ… é…ç½®æ­¥éª¤å¯æ“ä½œæ€§å¼º
- âœ… è¡¥å……äº† Docker æƒé™é…ç½®
- âœ… æä¾›äº†å®Œæ•´çš„ä½¿ç”¨æŒ‡å—

---

*æ–‡æ¡£æ›´æ­£å®Œæˆæ—¶é—´: 2025-09-29*  
*å¯¹æ¯”è„šæœ¬ç‰ˆæœ¬: init-users.sh (572 lines)*  
*ä¸»è¦æ›´æ­£: ç”¨æˆ·ä½“ç³»è®¾è®¡ä¸å®é™…è„šæœ¬ä¸€è‡´*